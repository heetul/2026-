<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 MLB Fantasy Draft Roulette</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap');
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #f3f4f6;
        }
        #wheel-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            aspect-ratio: 1 / 1;
            margin: 0 auto;
        }
        canvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 35px solid #ef4444; /* Red pointer */
            z-index: 10;
            filter: drop-shadow(0 4px 3px rgba(0,0,0,0.3));
        }
        .center-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 24px;
            height: 24px;
            background-color: white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 5;
        }
    </style>
</head>
<body class="min-h-screen text-gray-800 p-4 md:p-8 flex flex-col">

    <!-- Header -->
    <header class="text-center mb-6">
        <h1 class="text-3xl md:text-4xl font-extrabold text-blue-900 mb-2">
            âš¾ 2026 MLB íŒíƒ€ì§€ ë¦¬ê·¸ ë“œë˜í”„íŠ¸ ì¶”ì²¨
        </h1>
        <p class="text-gray-600 font-medium">ë“œë˜í”„íŠ¸ ìë¦¬ë¥¼ ì„ íƒí•  ìˆ˜ ìˆëŠ” ê¶Œë¦¬ë¥¼ ì¶”ì²¨í•©ë‹ˆë‹¤! (1ìœ„ë¶€í„° 14ìœ„ê¹Œì§€)</p>
    </header>

    <!-- Rule Explanation Banner -->
    <div class="max-w-4xl mx-auto bg-blue-50 border-l-4 border-blue-500 p-4 mb-8 rounded-r-lg shadow-sm">
        <h3 class="font-bold text-blue-800 flex items-center gap-2">
            <i class="fas fa-info-circle"></i> 2026 ì‹œì¦Œ íŠ¹ë³„ ë£°: ì‹¤ë ¥ì & ë…¸ë ¥íŒŒ ë³´ì • (Efficiency Bonus)
        </h3>
        <p class="text-sm text-blue-700 mt-1 leading-relaxed">
            Movesê°€ ì ë”ë¼ë„ ìµœì¢… ìˆœìœ„ê°€ ë†’ì€ íŒ€ì€ 'ë›°ì–´ë‚œ ê´€ë¦¬ ì‹¤ë ¥'ìœ¼ë¡œ ì¸ì •í•˜ì—¬ ìµœì†Œí•œ ìì‹ ì˜ ë“±ìˆ˜ë§Œí¼ì˜ ë³´ë„ˆìŠ¤ í™•ë¥ ì„ ë³´ì¥ë°›ìŠµë‹ˆë‹¤.<br>
            <strong>ğŸŸï¸ íšë“ í‹°ì¼“ ì‚°ì •ì‹:</strong> ì‘ë…„ ìˆœìœ„ ì ìˆ˜ + <strong>MAX</strong>(ìˆœìœ„ ì ìˆ˜, Moves ë­í‚¹ ì ìˆ˜)
        </p>
    </div>

    <div class="max-w-6xl w-full mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8 flex-grow">
        
        <!-- Left: Roulette Area -->
        <div class="lg:col-span-7 flex flex-col items-center bg-white p-6 rounded-2xl shadow-lg border border-gray-100">
            <h2 class="text-xl font-bold mb-6 text-gray-700 w-full text-center" id="turn-indicator">1ë²ˆì§¸ ì„ íƒê¶Œ ì¶”ì²¨ ì¤‘...</h2>
            
            <div id="wheel-container" class="mb-8">
                <div class="pointer"></div>
                <canvas id="wheel" width="600" height="600"></canvas>
                <div class="center-dot"></div>
            </div>

            <button id="spin-btn" class="w-full max-w-md bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-full shadow-lg transform transition hover:scale-105 active:scale-95 text-xl disabled:opacity-50 disabled:cursor-not-allowed">
                SPIN! ğŸ¯
            </button>
        </div>

        <!-- Right: Status Area -->
        <div class="lg:col-span-5 flex flex-col gap-6">
            
            <!-- Result Panel -->
            <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden flex-grow flex flex-col h-[300px]">
                <div class="bg-blue-900 text-white py-3 px-5 font-bold flex justify-between items-center">
                    <span>ğŸ† ë“œë˜í”„íŠ¸ í”½ ì„ íƒ ìˆœì„œ</span>
                    <span class="text-xs bg-blue-700 px-2 py-1 rounded">ê²°ê³¼</span>
                </div>
                <div class="p-0 overflow-y-auto flex-grow" id="result-list">
                    <!-- Results will be injected here -->
                    <div class="text-center text-gray-400 py-10 text-sm">ì¶”ì²¨ì´ ì‹œì‘ë˜ë©´ ì—¬ê¸°ì— ê¸°ë¡ë©ë‹ˆë‹¤.</div>
                </div>
            </div>

            <!-- Remaining Teams Panel -->
            <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden flex-grow flex flex-col h-[300px]">
                <div class="bg-gray-100 text-gray-700 py-3 px-5 font-bold flex justify-between items-center border-b">
                    <span>ğŸŸï¸ ë‚¨ì€ íŒ€ ë° ë‹¹ì²¨ í™•ë¥ </span>
                    <span id="total-tickets-display" class="text-xs bg-gray-300 text-gray-800 px-2 py-1 rounded"></span>
                </div>
                <div class="p-0 overflow-y-auto flex-grow" id="team-list">
                    <!-- Active teams will be injected here -->
                </div>
            </div>

        </div>
    </div>

    <!-- Modal for Winner Announcement -->
    <div id="winner-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden z-50 flex items-center justify-center backdrop-blur-sm transition-opacity">
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-sm w-full mx-4 transform scale-95 transition-transform duration-300 relative text-center" id="modal-content">
            <div class="text-6xl mb-4" id="modal-icon">ğŸ‰</div>
            <h3 class="text-sm font-bold text-gray-500 mb-1" id="modal-subtitle"></h3>
            <h2 class="text-2xl font-extrabold text-blue-900 mb-6" id="modal-title"></h2>
            
            <button id="modal-close-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-xl shadow transition">
                í™•ì¸ (ë‹¤ìŒ ì¶”ì²¨ ì§„í–‰)
            </button>
        </div>
    </div>

    <script>
        // Updated Data based on the 2025 season calculation with 'Efficiency Bonus'
        // Formula: Rank Points + MAX(Rank Points, Moves Points)
        const initialTeams = [
            { id: 1, name: "KAIA Commissioner", tickets: 28, color: "#ef4444" },  // Rank 1(14) + Max(14, Move 14) = 28
            { id: 7, name: "daily sia", tickets: 26, color: "#10b981" },          // Rank 2(13) + Max(13, Move 4) = 26
            { id: 6, name: "Sleeping Jihoo", tickets: 24, color: "#22c55e" },     // Rank 3(12) + Max(12, Move 6) = 24
            { id: 2, name: "10 LuckyVickies", tickets: 23, color: "#f97316" },    // Rank 4(11) + Max(11, Move 12) = 23
            { id: 3, name: "SNCD Working All Day", tickets: 21, color: "#f59e0b" },// Rank 5(10) + Max(10, Move 11) = 21
            { id: 4, name: "Summer Gnocchi", tickets: 20, color: "#eab308" },     // Rank 9(6) + Max(6, Move 14) = 20
            { id: 5, name: "Multi Champion", tickets: 19, color: "#84cc16" },     // Rank 6(9) + Max(9, Move 10) = 19
            { id: 8, name: "Yame Home Cook", tickets: 16, color: "#14b8a6" },     // Rank 7(8) + Max(8, Move 7) = 16
            { id: 12, name: "Not Seoul Mayor", tickets: 14, color: "#8b5cf6" },   // Rank 8(7) + Max(7, Move 1) = 14
            { id: 9, name: "Married Residents", tickets: 11, color: "#06b6d4" },  // Rank 12(3) + Max(3, Move 8) = 11
            { id: 10, name: "Mother Tucker", tickets: 11, color: "#3b82f6" },     // Rank 13(2) + Max(2, Move 9) = 11
            { id: 11, name: "ORANGE SHOHEI", tickets: 10, color: "#6366f1" },     // Rank 10(5) + Max(5, Move 5) = 10
            { id: 13, name: "Unfree Dobby Team", tickets: 8, color: "#d946ef" },  // Rank 11(4) + Max(4, Move 2) = 8
            { id: 14, name: "Yubu airdoshi", tickets: 4, color: "#f43f5e" }       // Rank 14(1) + Max(1, Move 3) = 4
        ];

        let activeTeams = [...initialTeams];
        let winners = [];
        
        // Canvas setup
        const canvas = document.getElementById('wheel');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spin-btn');
        
        // Physics variables
        let currentRotation = 0;
        let isSpinning = false;
        let spinVelocity = 0;
        let animationFrameId;

        // Draw the wheel
        function drawWheel() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (activeTeams.length === 0) {
                // All done
                ctx.beginPath();
                ctx.arc(300, 300, 300, 0, 2 * Math.PI);
                ctx.fillStyle = '#e5e7eb';
                ctx.fill();
                ctx.fillStyle = '#9ca3af';
                ctx.font = 'bold 30px Pretendard';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('ì¶”ì²¨ ì¢…ë£Œ', 300, 300);
                return;
            }

            const totalTickets = activeTeams.reduce((sum, team) => sum + team.tickets, 0);
            let startAngle = currentRotation;

            for (let i = 0; i < activeTeams.length; i++) {
                const team = activeTeams[i];
                // Calculate slice angle based on tickets
                const sliceAngle = (team.tickets / totalTickets) * 2 * Math.PI;
                
                // Draw slice
                ctx.beginPath();
                ctx.moveTo(300, 300);
                ctx.arc(300, 300, 300, startAngle, startAngle + sliceAngle);
                ctx.closePath();
                ctx.fillStyle = team.color;
                ctx.fill();
                ctx.lineWidth = 2;
                ctx.strokeStyle = '#ffffff';
                ctx.stroke();

                // Draw text
                ctx.save();
                ctx.translate(300, 300);
                // Rotate to the center of the slice
                ctx.rotate(startAngle + sliceAngle / 2);
                ctx.textAlign = 'right';
                ctx.textBaseline = 'middle';
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 22px Pretendard';
                
                // Add shadow for readability
                ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
                ctx.shadowBlur = 4;
                ctx.shadowOffsetX = 1;
                ctx.shadowOffsetY = 1;

                // Truncate long names slightly if needed
                let displayName = team.name;
                if(displayName.length > 14) displayName = displayName.substring(0, 13) + '...';
                
                // Move text to the edge
                ctx.fillText(displayName, 280, 0);
                ctx.restore();

                startAngle += sliceAngle;
            }
        }

        // Spin Logic
        function spin() {
            if (isSpinning || activeTeams.length === 0) return;
            
            isSpinning = true;
            spinBtn.disabled = true;
            
            // Randomize starting velocity for unpredictability
            spinVelocity = Math.random() * 0.15 + 0.35; 
            
            animate();
        }

        function animate() {
            currentRotation += spinVelocity;
            
            // Apply friction (deceleration)
            spinVelocity *= 0.985; 
            
            // Limit currentRotation to prevent overflow issues
            currentRotation = currentRotation % (2 * Math.PI);

            drawWheel();

            if (spinVelocity < 0.0015) {
                // Stop spinning
                spinVelocity = 0;
                isSpinning = false;
                determineWinner();
            } else {
                animationFrameId = requestAnimationFrame(animate);
            }
        }

        function determineWinner() {
            const totalTickets = activeTeams.reduce((sum, team) => sum + team.tickets, 0);
            
            // The pointer is at the top, which is angle -PI/2 (or 270 degrees)
            const pointerAngle = (3 * Math.PI) / 2; 
            
            // Adjust pointer angle based on current rotation to see where it lands on the unrotated wheel
            let relativeAngle = (pointerAngle - currentRotation) % (2 * Math.PI);
            if (relativeAngle < 0) {
                relativeAngle += 2 * Math.PI;
            }

            let accumulatedAngle = 0;
            let winningTeamIndex = -1;

            for (let i = 0; i < activeTeams.length; i++) {
                const sliceAngle = (activeTeams[i].tickets / totalTickets) * 2 * Math.PI;
                if (relativeAngle >= accumulatedAngle && relativeAngle < accumulatedAngle + sliceAngle) {
                    winningTeamIndex = i;
                    break;
                }
                accumulatedAngle += sliceAngle;
            }

            if (winningTeamIndex !== -1) {
                const winner = activeTeams[winningTeamIndex];
                showModal(winner);
            }
        }

        // UI Updates
        function updateUI() {
            const teamListEl = document.getElementById('team-list');
            const resultListEl = document.getElementById('result-list');
            const totalTicketsEl = document.getElementById('total-tickets-display');
            const turnIndicator = document.getElementById('turn-indicator');

            // Update Remaining Teams
            teamListEl.innerHTML = '';
            const totalTickets = activeTeams.reduce((sum, team) => sum + team.tickets, 0);
            totalTicketsEl.textContent = `ì´ í‹°ì¼“: ${totalTickets}ì¥`;

            // Sort active teams by tickets descending for display
            const sortedActive = [...activeTeams].sort((a, b) => b.tickets - a.tickets);

            sortedActive.forEach((team) => {
                const probability = totalTickets > 0 ? ((team.tickets / totalTickets) * 100).toFixed(1) : 0;
                
                const item = document.createElement('div');
                item.className = 'flex items-center justify-between p-3 border-b border-gray-100 hover:bg-gray-50 transition';
                item.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="w-4 h-4 rounded-full shadow-sm" style="background-color: ${team.color}"></span>
                        <span class="font-semibold text-gray-700">${team.name}</span>
                    </div>
                    <div class="text-right">
                        <div class="text-sm font-bold text-blue-600">${probability}%</div>
                        <div class="text-xs text-gray-500">${team.tickets}ì¥</div>
                    </div>
                `;
                teamListEl.appendChild(item);
            });

            if (activeTeams.length === 0) {
                teamListEl.innerHTML = '<div class="p-6 text-center text-gray-400">ëª¨ë“  ì¶”ì²¨ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</div>';
            }

            // Update Results
            resultListEl.innerHTML = '';
            if (winners.length === 0) {
                resultListEl.innerHTML = '<div class="text-center text-gray-400 py-10 text-sm">ì¶”ì²¨ì´ ì‹œì‘ë˜ë©´ ì—¬ê¸°ì— ê¸°ë¡ë©ë‹ˆë‹¤.</div>';
            } else {
                winners.forEach((winner, index) => {
                    const item = document.createElement('div');
                    item.className = 'flex items-center p-3 border-b border-gray-100 bg-gray-50';
                    item.innerHTML = `
                        <div class="w-10 h-10 flex-shrink-0 bg-blue-100 text-blue-800 font-bold rounded-full flex items-center justify-center mr-4">
                            ${index + 1}
                        </div>
                        <div class="font-bold text-gray-800 flex-grow text-lg">
                            ${winner.name}
                        </div>
                        <div class="text-xs font-semibold text-blue-500 bg-blue-100 px-2 py-1 rounded">
                            ì„ íƒê¶Œ íšë“
                        </div>
                    `;
                    resultListEl.appendChild(item);
                });
            }

            // Update Turn Indicator
            if (winners.length < 14) {
                turnIndicator.textContent = `${winners.length + 1}ë²ˆì§¸ í”½ ì„ íƒê¶Œ ì¶”ì²¨ ì¤‘...`;
            } else {
                turnIndicator.textContent = "ğŸ‰ ëª¨ë“  ë“œë˜í”„íŠ¸ ìˆœì„œ ì¶”ì²¨ ì™„ë£Œ! ğŸ‰";
                spinBtn.style.display = 'none';
            }
        }

        // Modal Logic
        const modal = document.getElementById('winner-modal');
        const modalContent = document.getElementById('modal-content');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        let currentWinner = null;

        function showModal(winner) {
            currentWinner = winner;
            const rank = winners.length + 1;
            
            document.getElementById('modal-subtitle').textContent = `ì œ ${rank} ìˆœìœ„ ì„ íƒê¶Œ ë‹¹ì²¨!`;
            document.getElementById('modal-title').textContent = winner.name;
            
            // Add a little pop animation
            modalContent.classList.remove('scale-100');
            modalContent.classList.add('scale-95');
            
            modal.classList.remove('hidden');
            
            setTimeout(() => {
                modalContent.classList.remove('scale-95');
                modalContent.classList.add('scale-100');
            }, 10);
        }

        function closeModal() {
            modal.classList.add('hidden');
            if (currentWinner) {
                // Move from active to winners
                winners.push(currentWinner);
                activeTeams = activeTeams.filter(t => t.id !== currentWinner.id);
                currentWinner = null;
                
                // Refresh UI and Canvas
                updateUI();
                drawWheel();
                
                if (activeTeams.length > 0) {
                    spinBtn.disabled = false;
                }
            }
        }

        // Event Listeners
        spinBtn.addEventListener('click', spin);
        modalCloseBtn.addEventListener('click', closeModal);

        // Initialization
        updateUI();
        drawWheel();

    </script>
</body>
</html>